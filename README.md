בהתאם להנחיות במטלה 3 ולחומר הלימוד שהוצג במצגות, להלן פירוט טכני של סדר הפעולות הנדרש לביצוע המטלה:

### שלב 1: הכנת הנתונים ועיבוד מקדים (Pre-processing)

1.  **הורדת נתונים:** הורד את קובץ ה-CSV המכיל את מילות השירים (600 לאימון ו-5 לבדיקה) ואת קובץ ה-ZIP עם קובצי ה-MIDI.


####################################### לא בוצע עדיין ###################################################


2.  **ניתוח קובצי MIDI:** השתמש בספריית `Pretty_Midi` כדי לחלץ מידע מהמלודיות, כגון תווים, כלי נגינה ותזמון.
3.  **טוקניזציה (Tokenization):** פרק את הטקסט של מילות השירים למילים בודדות.
4.  **ייצוג וקטורי למילים:** טען ייצוגי **Word2Vec** מוכנים (300 ממדים לכל מילה) והמר כל מילה בשירים לווקטור המתאים לה.
5.  **יצירת וקטור המלודיה:** הגדר שיטה לייצוג המידע מה-MIDI כווקטור מספרי שניתן להזין למודל בכל צעד זמן.
6.  **בניית מערך הנתונים (Dataset):** הכן רצפים שבהם הקלט בכל שלב $t$ הוא המילה הנוכחית ($x^{<t>}$) בצירוף מידע המלודיה, והמטרה (Label) היא ניבוי המילה הבאה ברצף ($x^{<t+1>}$).

### שלב 2: תכנון ארכיטקטורת המודל

7.  **בחירת סוג הרשת:** בחר בשכבה רקורסיבית מסוג **LSTM** או **GRU** כדי להתמודד עם תלויות לטווח ארוך.
8.  **הגדרת שכבת הכניסה:** תכנן את השכבה כך שתקבל ווקטור משולב (Concatenated) הכולל את ה-Word2Vec של המילה (300 ממדים) ואת תכונות המלודיה שנבחרו.
9.  **מימוש שתי גישות לשילוב המלודיה:** עליך לתכנן שתי וריאציות שונות לשילוב המידע מה-MIDI (למשל: הזנת ווקטור המלודיה בכל צעד זמן לעומת הזנתו רק כזיכרון ראשוני).
10. **שכבת הפלט:** הוסף שכבת **Linear** שאחריה פונקציית **Softmax** בגודל המילון (Vocabulary) כדי לקבל התפלגות הסתברויות על המילים הבאות האפשריות.

### שלב 3: תהליך האימון (Training)

11. **חלוקת נתונים:** פצל את הנתונים לסט אימון וסט וולידציה (Validation set).
12. **פונקציית הפסד (Loss Function):** הגדר פונקציית Cross Entropy למשימת ניבוי המילה הבאה.
13. **אופטימיזציה:** השתמש באלגוריתם **Backpropagation Through Time (BPTT)** לעדכון משקלי הרשת.
14. **ניטור:** השתמש ב-**TensorBoard** להצגת גרפים של ה-Loss באימון ובוולידציה.
15. **רגולריזציה:** ניתן להוסיף טכניקות כמו Dropout או Regularization במידת הצורך כדי למנוע Overfitting.

### שלב 4: יצירת טקסט (Inference/Sampling)

16. **הזנת קלט ראשוני:** בשלב הבדיקה, המודל מקבל מלודיה ומילה התחלתית.
17. **מנגנון דגימה (Sampling):** בצע בחירת מילה באופן **הסתברותי** (ולא דטרמיניסטי כמו argmax). ההסתברות לבחור מילה צריכה להיות פרופורציונלית לערך שקיבלה ב-Softmax.
18. **לולאת יצירה:** המילה שנדגמה בשלב $t$ מוזנת כקלט למודל בשלב $t+1$ יחד עם מידע המלודיה להמשך יצירת השיר.
19. **אכיפת חוקי מבנה:** קבע כללים (רצוי דרך פונקציית ההפסד) לגבי אורך הטקסט המקסימלי ומספר המילים בכל שורה, כדי שהתוצר ייראה כמו שיר אמיתי.

### שלב 5: בדיקה וניתוח

20. **הרצה על סט הבדיקה:** צור מילות שירים עבור 5 המלודיות בסט הבדיקה עבור כל אחת משתי הגישות שפיתחת.
21. **גיוון התחלות:** עבור כל מלודיה, בצע את תהליך היצירה 3 פעמים עם מילות פתיחה שונות.
22. **ניתוח תוצאות:** נתח את השפעת מילת הפתיחה או המלודיה על הטקסט שנוצר והשווה בין שתי הארכיטקטורות שפיתחת.

**אנלוגיה להמחשה:**
בניית המודל הזה דומה ל**אימון פסנתרן שכותב שירים**: אתה מלמד אותו לקרוא דף תווים (MIDI) ובמקביל לקרוא שירים קיימים. במהלך הלימוד, הוא מנסה לנחש מה תהיה המילה הבאה בכל שורה בהתבסס על המנגינה שמתנגנת ברקע. כשהוא מסיים להתאמן, אתה נותן לו מנגינה חדשה ומילה ראשונה, והוא מתחיל "לזרום" עם השיר, כשבכל רגע הוא בוחר את המילה הבאה לא רק לפי מה שהכי סביר, אלא עם מידה מסוימת של יצירתיות (דגימה הסתברותית).
